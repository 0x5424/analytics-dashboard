{
  /* Visit https://firebase.google.com/docs/database/security to learn more about security rules. */
  "rules": {
    ".read": "auth.token.role == 'admin'",
    ".write": "auth.token.role == 'admin'",
    "talents": {
      "timestamp": {".validate": "newData.val() == now"},
      "twitter_user_id": {
        ".validate": "root.child('twitters/' + newData.val()).exists()" // Ensure twitter persisted
      },
      "created_at": {".validate": "newData.val() == now && !data.exists()"}, // Write once
      "$other": {".validate": false} // END TALENTS
    },
    "twitters": {
      ".validate": "newData.hasChildren(['screen_name', 'oauth_token', 'oauth_token_secret'])",
      "timestamp": {".validate": "newData.val() == now"},
      "screen_name": {
        ".validate": "newData.isString()" // Username/handles may change, twitter_id/token/secret should not
      },
      "oauth_token": {".validate": "newData.isString() && !data.exists()"},
      "oauth_token_secret": {".validate": "newData.isString() && !data.exists()"},
      "created_at": {".validate": "newData.val() == now && !data.exists()"}, // Write once
      "$other": {".validate": false} // END TWITTERS
    },
    "$other": {".validate": false} // No additional documents
  }
}
